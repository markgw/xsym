Conneau word translation training
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. py:module:: langsim.modules.embedding_map.conneau

+------------+---------------------------------------+
| Path       | langsim.modules.embedding_map.conneau |
+------------+---------------------------------------+
| Executable | yes                                   |
+------------+---------------------------------------+
| Stages     | adversarial, refinement               |
+------------+---------------------------------------+


Inputs
======

+----------+---------------------------------------------------------------+
| Name     | Type(s)                                                       |
+==========+===============================================================+
| vectors1 | :class:`Embeddings <pimlico.datatypes.embeddings.Embeddings>` |
+----------+---------------------------------------------------------------+
| vectors2 | :class:`Embeddings <pimlico.datatypes.embeddings.Embeddings>` |
+----------+---------------------------------------------------------------+

Outputs
=======

+---------+-----------------------------------------------+
| Name    | Type(s)                                       |
+=========+===============================================+
| mapping | :class:`~pimlico.datatypes.arrays.NumpyArray` |
+---------+-----------------------------------------------+

Options
=======

+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| Name                             | Description                                                                                                                                                                                                                                                                                                                                                     | Type                            |
+==================================+=================================================================================================================================================================================================================================================================================================================================================================+=================================+
| adversarial_min_freq             | Minimum frequency of word in original dataset for it to be included in training. Default: 5 (asin paper)                                                                                                                                                                                                                                                        | int                             |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| adversarial_weeding_freq         | Number of iterations to perform between each time we weed out the least promising models. Default: 1                                                                                                                                                                                                                                                            | int                             |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| adversarial_decay                | Level of decay in training. Default: 0.95 (as in paper)                                                                                                                                                                                                                                                                                                         | float                           |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| adversarial_discriminator_words  | Number of most frequent words to draw discriminator samples from. Default: 50k (as in paper)                                                                                                                                                                                                                                                                    | int                             |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| adversarial_dropout              | Level of dropout noise to apply to input embeddings. Default: 0.1 (as in paper)                                                                                                                                                                                                                                                                                 | float                           |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| adversarial_val_crit_lr_red      | Halve LR every time val crit decreases between iterations. Default: True                                                                                                                                                                                                                                                                                        | bool                            |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| adversarial_language_ids         | Comma-separated list of IDs to use for the two models that we're mapping into a common space. When the mapped space is output, words are distinguished using these IDs. If not given, numeric IDs are used by default                                                                                                                                           | comma-separated list of strings |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| adversarial_orthogonality        | Whether to apply orthogonality constraint between updates. If 0, don't apply constraint. Otherwise, value specifies beta parameter. Default: 0.01 (as in paper)                                                                                                                                                                                                 | float                           |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| adversarial_batch                | Batch size for training of discriminator and mapping                                                                                                                                                                                                                                                                                                            | int                             |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| adversarial_iteration_samples    | How many samples constitute a single epoch. It's unclear from the paper what 'epoch' means, since the data is being sampled, rather than iterated over. You might want to set this to the same as discriminator_words, which seems to make sense, but I suspect they used a high value. Default: 200k                                                           | int                             |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| adversarial_lr                   | Learning rate for SGD updates. Default: 0.1 (as in paper)                                                                                                                                                                                                                                                                                                       | float                           |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| adversarial_discriminator_layers | List of layer sizes for discriminator. Does not include input (embedding size) or output(single value). Default: 2048,2048 (as in paper)                                                                                                                                                                                                                        | comma-separated list of ints    |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| adversarial_iterations           | Number of complete training epochs. Fewer might be completed if early stopping is enabled                                                                                                                                                                                                                                                                       | int                             |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| adversarial_smoothing            | Smoothing coefficient for discriminator predictions. Default: 0.2 (as in paper)                                                                                                                                                                                                                                                                                 | float                           |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| adversarial_tolerance            | Number of iterations to continue training without an improvement in the validation criterion. If we perform this number of operations without the val crit increasing, give up and stop. Set to 0 to disable early stopping altogether. Default: 5                                                                                                              | int                             |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| adversarial_k                    | K parameter for CSLS metric used in computing unsupervised validation criterion                                                                                                                                                                                                                                                                                 | int                             |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| adversarial_num_starts           | Number of different models to initialize and start training. After each training iteration (for every model), half of the models are thrown away, based on the validation criterion, keeping just the most promising. After a few iterations, just a single model is left and this is trained to completion. It is best to set this to a power of 2. Default: 8 | int                             |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| refinement_k                     | K parameter for CSLS metric used to build parallel vocabulary                                                                                                                                                                                                                                                                                                   | int                             |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| refinement_language_ids          | Comma-separated list of IDs to use for the two models that we're mapping into a common space. When the mapped space is output, words are distinguished using these IDs. If not given, numeric IDs are used by default                                                                                                                                           | comma-separated list of strings |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| refinement_num_most_freq         | Number of most frequent words to consider as translation pairs when building the parallel vocabulary. The paper says they use only the most frequent words, but not how many. My best guess is the same limit used when training the discriminator, 50k. Default: 50k                                                                                           | int                             |
+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+

Submodules
==========

.. toctree::
   :titlesonly:

   langsim.modules.embedding_map.conneau.adversarial
   langsim.modules.embedding_map.conneau.refinement
